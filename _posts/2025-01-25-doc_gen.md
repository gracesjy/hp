---
title: MS Word Generation
author: Raymond
date: 2025-07-01
category: Jekyll
layout: post
---



## ✅<span style="color:#034299"> 개요

PDF 문서에서 데이터를 추출하는데는 확실히 제한적이다.  특히 표 형태에서는 매우 취약하며 보안 관련 배경 문자열(Conferdential) 이
있을 경우에는 정말 엉망진창의 추출이 된다. <br>

반면 MS Word 문서가 만약 서식이 지켜지는 방식으로 작성되었다면 이를 Reverse 해서 데이터를 추출하기 매우 용이하며,
또한 DB 를 통해서 MS Word 문서를 서식에 의해 만들고 이를 PDF 포맷이나 HTML, Mark Down 형태로 만드는 것은 거의 완벽하다.
<br>
표에 관해서는 MS Word 를 가지고 만들 때 사용하는 Merge, 줄 맞춤 등을 코드화 하여 생성하거나, 이미 되어 있는 경우에도 거의 완벽하게 각 셀에
대한 원본 데이터 추출이 가능하다.<br>

특히 기본적인 Template Word 문서가 제공되었을 때, 우리는 Python 상용 패키지인 Spire-Doc 을 가지고 문서를 생성할 수 있고
복잡현 표의 형태도 자유롭게 Python 으로 손쉽게 만들 수 있다.

이때 BDAE (Big Data Aanlysis Enabler) 를 사용한다면 백앤드는 이 SQL 문만 호출하면 되기 때문에 매우 효과적이라고 할 수 있다.
특히 복잡한 형태의 표가 섞여 있는 경우 효과적이며 체계적이라고 볼 수 있다.<br>



## ✅<span style="color:#034299"> Using BDAE
아래 BDAE SQL 문을 살펴 보면 먼저 MS Word 템플릿을 지정하고, Python 에서 만들어 낼 여러 테이블의 Where 절에 해당 되는 값들을
넘겨 주는 두 번째 cursor 를 만든다. 리턴 포맷은 MS-WORD, HTML, PDF 등으로 설정할 수 있고 가장 중요한 Python 모듈과 함수를 지정하면 된다.<br>
이 SQL 문을 호출하면 MS-WORD, PDF 는 BLOB 형태로 넘어 오며, HTML, MARKDOWN 의 경우는 CLOB 형태로 SQL 결과를 받게 된다.
```
SELECT * FROM table(apTableEval(
    cursor(SELECT * FROM WordTemplateDB WHERE ID = 'MOSTemplate' AND VERSION='1.1.0'), --
    cursor(SELECT 'PRD_01' AS PRODUCT_ID, 'RECIPE_01' AS RECIPE_ID, .. FROM dual),
    'MS-WORD',
    'WORD_GEN_01:start'
))
```

## ✅<span style="color:#034299"> 후기
예전에 프로젝트를 할 때 이런 것들에 대한 프로토타입을 하였었다.  사람들은 Report 툴을 이야기 했었지만 전혀 매칭이 되지 않았다.
BDAE 는 백앤드를 매우 간단하게 만든다.  SQL 문 호출만 하면 되기 때문이다.  이기종 언어 (Python, R)를 백앤드에서는 SQL 문 형태로
호출하기 때문에 복잡성을 단순하게 만든다. <br>



